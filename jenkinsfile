pipeline {
    agent any

    stages {
        // Previous stages remain unchanged

        stage('Deploy to SSH host') {
            when {
                expression {
                    return (env.BRANCH_NAME == 'Development' || env.BRANCH_NAME == 'Production' || env.BRANCH_NAME == 'Staging')
                }
            }
            steps {
                script {
                    // Assuming you have already set up passwordless SSH access
                    sh "ssh ubuntu@13.232.231.36 'mkdir -p /home/ubuntu/newnd_${env.BRANCH_NAME} && scp -r /var/lib/jenkins/workspace/newnd_${env.BRANCH_NAME}/* /home/ubuntu/newnd_${env.BRANCH_NAME}/'"
                }
            }
        }

        // Add more stages as needed
    }

    post {
        success {
            echo 'Pipeline succeeded! All stages completed successfully.'
        }
        failure {
            echo 'Pipeline failed! At least one stage failed.'
        }
    }
}
